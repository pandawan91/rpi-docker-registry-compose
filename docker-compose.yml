version: '2.0'
services:
  storage:
    image: hypriot/armhf-busybox
    restart: always
    volumes:
      - /var/lib/docker/registry
      - ./config.yml:/etc/docker/registry/config.yml
  cache:
    restart: always
    image: hypriot/rpi-redis
  backend:
    image: pandawan1991/rpi-docker-registry
    restart: always
    ports:
    - 5000:5000
    links:
      - cache
      - storage
    networks:
      - outside
    volumes_from:
      - storage
    environment:
      SETTINGS_FLAVOR: local
      STORAGE_PATH: /var/lib/docker/registry
      SEARCH_BACKEND: sqlalchemy
      CACHE_REDIS_HOST: cache
      CACHE_REDIS_PORT: 6379
      CACHE_LRU_REDIS_HOST: cache
      CACHE_LRU_REDIS_PORT: 6379
networks:
  outside:
    external: true
